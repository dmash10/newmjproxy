"use strict";(self.webpackChunkmidjourney_proxy_admin=self.webpackChunkmidjourney_proxy_admin||[]).push([[903],{39936:function(Nr,we,o){o.r(we),o.d(we,{default:function(){return Ea}});var ca=o(97857),T=o.n(ca),pa=o(15009),I=o.n(pa),ga=o(64599),q=o.n(ga),fa=o(19632),ma=o.n(fa),va=o(99289),z=o.n(va),ha=o(5574),v=o.n(ha),A=o(66927),Sa=o(18429),ba=o(51042),Ce=o(52645),ya=o(90930),wa=o(94272),W=o(55102),ne=o(4393),Ca=o(16568),b=o(2453),Z=o(83622),ja=o(68997),B=o(86250),_=o(42075),Ta=o(66309),Ia=o(58073),je=o(74330),Aa=o(38703),N=o(66476),Te=o(78045),Ie=o(74656),Pa=o(28248),f=o(67294),Ae=o(30538),de={cardTitleTime:"cardTitleTime___ULudn",taskErrorTip:"taskErrorTip___EJ9yV"},r=o(85893),ie=W.Z.TextArea,xa=ne.Z.Meta,Za=function(){var Ma=Ca.ZP.useNotification(),Pe=v()(Ma,2),L=Pe[0],Fa=Pe[1],Ra=(0,f.useState)([]),xe=v()(Ra,2),ka=xe[0],Ze=xe[1],Ua=(0,f.useState)(!1),Ee=v()(Ua,2),Ba=Ee[0],Me=Ee[1],La=(0,f.useState)("imagine"),Fe=v()(La,2),w=Fe[0],Oa=Fe[1],Da=(0,f.useState)("MID_JOURNEY"),Re=v()(Da,2),j=Re[0],Na=Re[1],Ja=(0,f.useState)(""),ke=v()(Ja,2),E=ke[0],V=ke[1],Wa=(0,f.useState)("SQUARE"),Ue=v()(Wa,2),Be=Ue[0],Va=Ue[1],Ga=(0,f.useState)([]),Le=v()(Ga,2),O=Le[0],G=Le[1],Ha=(0,f.useState)([]),Oe=v()(Ha,2),R=Oe[0],ee=Oe[1],za=(0,f.useState)([]),De=v()(za,2),k=De[0],ae=De[1],Ya=(0,f.useState)(""),Ne=v()(Ya,2),$a=Ne[0],Je=Ne[1],Xa=(0,f.useState)(!1),We=v()(Xa,2),J=We[0],P=We[1],Qa=(0,f.useState)(new Set),Ka=v()(Qa,1),C=Ka[0],qa=(0,f.useState)(!1),Ve=v()(qa,2),_a=Ve[0],Y=Ve[1],er=(0,f.useState)(""),Ge=v()(er,2),ar=Ge[0],rr=Ge[1],sr=(0,f.useState)(""),He=v()(sr,2),le=He[0],ze=He[1],tr=(0,f.useState)(""),Ye=v()(tr,2),ce=Ye[0],nr=Ye[1],ir=(0,f.useState)(""),$e=v()(ir,2),oe=$e[0],Xe=$e[1],lr=(0,f.useState)(0),Qe=v()(lr,2),Ke=Qe[0],or=Qe[1],ur=(0,f.useState)(!1),qe=v()(ur,2),dr=qe[0],cr=qe[1],pr=(0,f.useState)(!1),_e=v()(pr,2),gr=_e[0],ea=_e[1],fr=(0,f.useState)([]),aa=v()(fr,2),ra=aa[0],re=aa[1],mr=(0,f.useState)(),sa=v()(mr,2),$=sa[0],vr=sa[1],u=(0,wa.useIntl)(),pe=(0,f.useRef)([]),X=(0,f.useRef)(null),D="midjourney-proxy-admin",ge=sessionStorage.getItem("mj-image-prefix")||"";(0,f.useEffect)(function(){return br({state:D,pageNumber:0,pageSize:3,statusSet:["NOT_START","SUBMITTED","IN_PROGRESS","FAILURE","SUCCESS"],sort:"submitTime,desc"}),X.current&&clearInterval(X.current),X.current=setInterval(function(){C.size!==0&&hr()},2e3),function(){X.current&&(clearInterval(X.current),X.current=null)}},[]);var hr=function(){var i=z()(I()().mark(function e(){var a,t,l,m,n,g,c,F,p,h,y;return I()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return a=Array.from(C),t=new Set(a),S.next=4,(0,A.BX)(a);case 4:l=S.sent,m=!1,n=ma()(pe.current),g=q()(l),S.prev=8,F=I()().mark(function K(){var U,s;return I()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:U=c.value,t.delete(U.id),(U.status==="FAILURE"||U.status==="SUCCESS"||U.status==="CANCEL")&&C.delete(U.id),s=n.find(function(Dr){return Dr.id===U.id}),s?Sr(s,U)||(m=!0,n.splice(n.indexOf(s),1,U)):(m=!0,n.push(U));case 5:case"end":return x.stop()}},K)}),g.s();case 11:if((c=g.n()).done){S.next=15;break}return S.delegateYield(F(),"t0",13);case 13:S.next=11;break;case 15:S.next=20;break;case 17:S.prev=17,S.t1=S.catch(8),g.e(S.t1);case 20:return S.prev=20,g.f(),S.finish(20);case 23:p=q()(t);try{for(p.s();!(h=p.n()).done;)y=h.value,C.delete(y)}catch(K){p.e(K)}finally{p.f()}m&&(pe.current=n,Ze(n),ta());case 26:case"end":return S.stop()}},e,null,[[8,17,20,23]])}));return function(){return i.apply(this,arguments)}}(),Sr=function(e,a){return e.status===a.status&&e.progress===a.progress&&e.imageUrl===a.imageUrl},ta=function(){setTimeout(function(){var e=document.getElementById("task-panel");e&&e.scrollTo(0,e.scrollHeight)},20)},br=function(){var i=z()(I()().mark(function e(a){var t,l,m,n,g,c;return I()().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return Me(!0),p.prev=1,p.next=4,(0,A.Ed)();case 4:t=p.sent,Array.isArray(t)?re(t):t&&Array.isArray(t.data)||t&&t.success&&Array.isArray(t.data)?re(t.data):(console.warn("Unexpected accounts response format:",t),re([])),p.next=12;break;case 8:p.prev=8,p.t0=p.catch(1),console.error("Error fetching accounts:",p.t0),re([]);case 12:return p.next=14,(0,A.Pn)(a);case 14:l=p.sent,m=l.list.reverse(),n=q()(m);try{for(n.s();!(g=n.n()).done;)c=g.value,c.status!=="FAILURE"&&c.status!=="SUCCESS"&&c.action!=="CANCEL"&&C.add(c.id)}catch(h){n.e(h)}finally{n.f()}pe.current=m,Ze(m),Me(!1),ta();case 22:case"end":return p.stop()}},e,null,[[1,8]])}));return function(a){return i.apply(this,arguments)}}(),yr=function(e){Oa(e),V(""),G([])},wr=function(e){vr(e)},Cr=function(e){var a=e.target.value;Na(a),V(""),G([])},jr=function(e){var a=e.target.value;Va(a)},ue=function(e){V(e.target.value)},na=function(e){ze(e.target.value)},Q=function(){var i=z()(I()().mark(function e(a){return I()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,new Promise(function(m){var n=new FileReader;n.onload=function(){return m(n.result)},n.readAsDataURL(a)});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},e)}));return function(a){return i.apply(this,arguments)}}(),M=function(){var i=z()(I()().mark(function e(){var a,t,l,m,n,g,c,F,p,h,y,te,S,K;return I()().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(!(j==="INSIGHT_FACE"||j==="FACE_SWAP")){s.next=26;break}if(!(R.length<1)){s.next=4;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),s.abrupt("return");case 4:if(!(k.length<1)){s.next=7;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),s.abrupt("return");case 7:if(P(!0),a={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:D},!R[0].originFileObj){s.next=15;break}return s.next=12,Q(R[0].originFileObj);case 12:a.sourceBase64=s.sent,s.next=16;break;case 15:a.sourceUrl=R[0].name;case 16:if(!k[0].originFileObj){s.next=22;break}return s.next=19,Q(k[0].originFileObj);case 19:a.targetBase64=s.sent,s.next=23;break;case 22:a.targetUrl=k[0].name;case 23:(0,A.Vl)(a).then(function(d){P(!1),d.code===22||d.code===1?(d.code===22?L.warning({message:"warn",description:d.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),C.add(d.result),ee([]),ae([])):L.error({message:"error",description:d.description})}),s.next=143;break;case 26:if(j!=="VIDEO_FACE_SWAP"){s.next=51;break}if(!(R.length<1)){s.next=30;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),s.abrupt("return");case 30:if(!(k.length<1)){s.next=33;break}return b.ZP.error(u.formatMessage({id:"pages.draw.swapTip"})),s.abrupt("return");case 33:if(P(!0),t={sourceUrl:"",targetUrl:"",sourceBase64:"",targetBase64:"",state:D},!R[0].originFileObj){s.next=41;break}return s.next=38,Q(R[0].originFileObj);case 38:t.sourceBase64=s.sent,s.next=42;break;case 41:t.sourceUrl=R[0].name;case 42:l=new FormData,k[0].originFileObj?l.append("TargetFile",k[0].originFileObj):t.targetUrl=k[0].name,l.append("SourceBase64",t.sourceBase64||""),l.append("SourceUrl",t.sourceUrl||""),l.append("TargetUrl",t.targetUrl||""),l.append("Satate",t.state),(0,A.Wv)(l,{headers:{"Content-Type":"multipart/form-data"}}).then(function(d){P(!1),d.code===22||d.code===1?(d.code===22?L.warning({message:"warn",description:d.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),C.add(d.result),ee([]),ae([])):L.error({message:"error",description:d.description})}),s.next=143;break;case 51:if(w!=="show"){s.next=59;break}if(E){s.next=55;break}return b.ZP.error(u.formatMessage({id:"pages.draw.taskIdNotBlank"})),s.abrupt("return");case 55:C.add(E),V(""),s.next=143;break;case 59:if(w!=="showjobid"){s.next=67;break}if(E){s.next=63;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),s.abrupt("return");case 63:P(!0),(0,A.cq)("show",{botType:j,jobId:E,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var x=se(d);x&&(C.add(d.result),V(""),G([]))}),s.next=143;break;case 67:if(w!=="imagine"){s.next=95;break}if(E){s.next=71;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),s.abrupt("return");case 71:P(!0),m=[],n=q()(O),s.prev=74,n.s();case 76:if((g=n.n()).done){s.next=84;break}return c=g.value,s.next=80,Q(c.originFileObj);case 80:F=s.sent,m.push(F);case 82:s.next=76;break;case 84:s.next=89;break;case 86:s.prev=86,s.t0=s.catch(74),n.e(s.t0);case 89:return s.prev=89,n.f(),s.finish(89);case 92:(0,A.qJ)(w,{botType:j,prompt:E,base64Array:m,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var x=se(d);x&&(C.add(d.result),V(""),G([]))}),s.next=143;break;case 95:if(w!=="blend"){s.next=123;break}if(!(O.length<2)){s.next=99;break}return b.ZP.error(u.formatMessage({id:"pages.draw.blendTip"})),s.abrupt("return");case 99:P(!0),p=[],h=q()(O),s.prev=102,h.s();case 104:if((y=h.n()).done){s.next=112;break}return te=y.value,s.next=108,Q(te.originFileObj);case 108:S=s.sent,p.push(S);case 110:s.next=104;break;case 112:s.next=117;break;case 114:s.prev=114,s.t1=s.catch(102),h.e(s.t1);case 117:return s.prev=117,h.f(),s.finish(117);case 120:(0,A.qJ)(w,{botType:j,base64Array:p,dimensions:Be,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var x=se(d);x&&(C.add(d.result),G([]))}),s.next=143;break;case 123:if(w!=="describe"){s.next=134;break}if(!(O.length<1)){s.next=127;break}return b.ZP.error(u.formatMessage({id:"pages.draw.imageEmptyTip"})),s.abrupt("return");case 127:return P(!0),s.next=130,Q(O[0].originFileObj);case 130:K=s.sent,(0,A.qJ)(w,{botType:j,base64:K,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var x=se(d);x&&(C.add(d.result),G([]))}),s.next=143;break;case 134:if(w!=="shorten"){s.next=142;break}if(E){s.next=138;break}return b.ZP.error(u.formatMessage({id:"pages.draw.promptNotBlank"})),s.abrupt("return");case 138:P(!0),(0,A.qJ)(w,{botType:j,prompt:E,state:D,accountFilter:{instanceId:$}}).then(function(d){P(!1);var x=se(d);x&&(C.add(d.result),V(""))}),s.next=143;break;case 142:b.ZP.error(u.formatMessage({id:"pages.draw.unsupportedAction"}));case 143:case"end":return s.stop()}},e,null,[[74,86,89,92],[102,114,117,120]])}));return function(){return i.apply(this,arguments)}}(),se=function(e){return e.code===22||e.code===1?(e.code===22?L.warning({message:"warn",description:e.description}):b.ZP.success(u.formatMessage({id:"pages.draw.submitSuccess"})),!0):(L.error({message:"error",description:e.description}),!1)},Tr=function(e,a){var t=a.customId,l=e.id,m="".concat(a.emoji," ").concat(a.label);Je("".concat(l,":").concat(t)),(0,A.qJ)("action",{taskId:l,customId:t,state:D,chooseSameChannel:!0}).then(function(n){if(Je(""),n.code===22)L.warning({message:"warn",description:n.description}),a.style=3,C.add(n.result);else if(n.code===21){if(a.style=3,rr("".concat(n.result," ").concat(m)),nr(n.result),ze(n.properties.finalPrompt),cr(n.properties.remix||!1),t.startsWith("MJ::Inpaint:")){var g="".concat(ge).concat(e.imageUrl),c=new Image;c.src=g,c.onload=function(){or(Math.floor(550/c.width*c.height)),Xe(g),Y(!0),setTimeout(function(){Ir()},300)}}else Xe(""),Y(!0);Y(!0)}else if(n.code===1){if(a.style=3,n.result){var F=n.result.split(",");F.forEach(function(p){C.add(p)})}b.ZP.success(u.formatMessage({id:"pages.draw.actionSuccess"}))}else L.error({message:"error",description:n.description})})},fe=!1,me=0,ve=0,Ir=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var a=e.getBoundingClientRect(),t=Math.floor(a.left),l=Math.floor(a.top),m=e.getContext("2d");m.fillStyle="blue",e.onmousedown=function(n){me=n.clientX,ve=n.clientY,fe=!0},e.onmousemove=function(n){fe===!0&&m.fillRect(me-t,ve-l,n.clientX-me,n.clientY-ve)},e.onmouseup=function(){fe=!1}},Ar=function(){(0,A.el)(ce),Y(!1)},Pr=function(){var i=z()(I()().mark(function e(){var a,t,l,m;return I()().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(ea(!0),!oe){g.next=11;break}return t=document.getElementById("canvas"),l=new Image,l.src=t.toDataURL("image/png"),g.next=7,xr(l);case 7:m=g.sent,a={maskBase64:m,taskId:ce,prompt:le},g.next=12;break;case 11:a={taskId:ce,prompt:le};case 12:(0,A.qJ)("modal",a).then(function(c){ea(!1),c.code===22?(L.warning({message:"warn",description:c.description}),C.add(c.result),Y(!1)):c.code===1?(C.add(c.result),Y(!1),b.ZP.success(u.formatMessage({id:"pages.draw.subSuccess"}))):L.error({message:"error",description:c.description})});case 13:case"end":return g.stop()}},e)}));return function(){return i.apply(this,arguments)}}(),xr=function(){var i=z()(I()().mark(function e(a){return I()().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,new Promise(function(m){a.onload=function(){var n=a.width,g=a.height,c=document.createElement("canvas"),F=c.getContext("2d");c.width=n,c.height=g,F.drawImage(a,0,0,n,g);for(var p=F.getImageData(0,0,n,g),h=p.data,y=0;y<h.length;y+=4)h[y]!==0||h[y+1]!==0||h[y+2]!==0?(h[y]=parseInt("0xff"),h[y+1]=parseInt("0xff"),h[y+2]=parseInt("0xff")):(h[y]=0,h[y+1]=0,h[y+2]=0,h[y+3]=255);F.putImageData(p,0,0);var te=c.toDataURL("png");m(te)}});case 2:return l.abrupt("return",l.sent);case 3:case"end":return l.stop()}},e)}));return function(a){return i.apply(this,arguments)}}(),Zr=function(e){var a="Midjourney - ".concat(e.displays.discordInstanceId);return e.botType==="NIJI_JOURNEY"?a="niji\u30FBjourney - ".concat(e.displays.discordInstanceId):(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP")&&(a="InsightFaceSwap - ".concat(e.displays.discordInstanceId)),e.status!=="SUCCESS"&&e.status!=="FAILURE"&&e.status!=="CANCEL"&&e.action!=="SWAP_FACE"?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:a}),(0,r.jsx)("span",{className:de.cardTitleTime,children:e.displays.submitTime}),(0,r.jsx)(Z.ZP,{style:{marginLeft:"10px"},type:"link",shape:"circle",icon:(0,r.jsx)(Sa.Z,{}),onClick:function(){return(0,A.el)(e.id)}})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{children:a}),(0,r.jsx)("span",{className:de.cardTitleTime,children:e.displays.submitTime})]})},Er=function(e){var a=e.description,t=e.properties.messageContent;return t&&(a=t.replace(/<@[^>]+>/g,"")),(0,r.jsx)(Ae.UG,{children:a})},Mr=function(){return ka.map(function(e){var a="./midjourney.webp";return e.botType==="NIJI_JOURNEY"?a="./niji.webp":(e.botType==="INSIGHT_FACE"||e.botType==="FACE_SWAP"||e.botType==="VIDEO_FACE_SWAP")&&(a="./insightface.webp"),(0,r.jsxs)(ne.Z,{bordered:!1,bodyStyle:{backgroundColor:"#eaeaea",marginBottom:"10px"},children:[(0,r.jsx)(xa,{avatar:(0,r.jsx)(ja.Z,{src:a}),title:Zr(e),description:Er(e)}),(0,r.jsxs)(B.Z,{vertical:!0,style:{paddingLeft:"48px"},children:[Ur(e),(0,r.jsx)(_.Z,{wrap:!0,style:{marginTop:"7px"},children:kr(e)})]})]},e.id)})},ia=function(e){if(!e.properties.finalPrompt)return(0,r.jsx)(r.Fragment,{});var a=e.properties.finalPrompt;return(0,r.jsx)(Ae.UG,{children:a.replace(new RegExp("(?<!\\n)\\n","g"),`

`)})},he=function(e){if(e.status==="FAILURE")return(0,r.jsx)("span",{className:de.taskErrorTip,children:e.failReason});if(e.status==="SUCCESS")return(0,r.jsx)(r.Fragment,{});if(e.status==="IN_PROGRESS")return(0,r.jsx)(r.Fragment,{children:Rr(e)});var a="purple";return e.status==="SUBMITTED"?a="lime":e.status==="CANCEL"?a="magenta":e.status==="MODAL"&&(a="warning"),(0,r.jsx)("span",{children:(0,r.jsx)(Ta.Z,{color:a,children:e.displays.status})})},la=function(e,a){return e?(0,r.jsx)(Ia.Z,{width:a,src:"".concat(ge).concat(e),placeholder:(0,r.jsx)(je.Z,{tip:"Loading",size:"large"})}):(0,r.jsx)(r.Fragment,{})},Fr=function(e,a){return e?(0,r.jsx)("video",{width:a,controls:!0,src:ge+e,placeholder:(0,r.jsx)(je.Z,{tip:"Loading",size:"large"})}):(0,r.jsx)(r.Fragment,{})},Rr=function(e){var a=e.progress,t=0;return a&&a.indexOf("%")>0&&(t=parseInt(a.substring(0,a.indexOf("%")))),(0,r.jsx)("span",{style:{width:250},children:(0,r.jsx)(Aa.Z,{percent:t,status:"normal"})})},kr=function(e){return e.buttons.map(function(a){return(0,r.jsxs)(Z.ZP,{ghost:!0,style:{backgroundColor:a.style===3?"#258146":"rgb(131 133 142)"},onClick:function(){Tr(e,a)},loading:$a==="".concat(e.id,":").concat(a.customId),children:[a.emoji," ",a.label]},"".concat(e.id,":").concat(a.customId))})},H=(0,r.jsxs)("div",{children:[(0,r.jsx)(ba.Z,{}),(0,r.jsx)("div",{style:{marginTop:8},children:"Upload"})]}),Ur=function(e){return e.action==="DESCRIBE"?(0,r.jsxs)(r.Fragment,{children:[he(e)," ",ia(e)," ",la(e.imageUrl,120)]}):e.action==="SHORTEN"?(0,r.jsxs)(r.Fragment,{children:[he(e)," ",ia(e)]}):(0,r.jsxs)(r.Fragment,{children:[he(e),e.action==="SWAP_VIDEO_FACE"?(0,r.jsx)(r.Fragment,{children:Fr(e.imageUrl,250)}):la(e.imageUrl,250)]})},Br=function(){return j==="INSIGHT_FACE"||j==="FACE_SWAP"?(0,r.jsxs)(B.Z,{vertical:!0,gap:8,children:[(0,r.jsx)(N.Z,T()(T()({},ua),{},{listType:"picture-card",children:R.length>=1?null:H})),(0,r.jsx)(W.Z,{onChange:function(a){a.target.value&&ee([{uid:"1",name:a.target.value,url:a.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap1Desc"})}),(0,r.jsx)(N.Z,T()(T()({},da),{},{listType:"picture-card",children:k.length>=1?null:H})),(0,r.jsx)(W.Z,{onChange:function(a){a.target.value&&ae([{uid:"2",name:a.target.value,url:a.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap2Desc"})}),(0,r.jsx)(Z.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.swapDesc"})})]}):j==="VIDEO_FACE_SWAP"?(0,r.jsxs)(B.Z,{vertical:!0,gap:8,children:[(0,r.jsx)(N.Z,T()(T()({},ua),{},{listType:"picture-card",children:R.length>=1?null:H})),(0,r.jsx)(W.Z,{onChange:function(a){a.target.value&&ee([{uid:"1",name:a.target.value,url:a.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap1Desc"})}),(0,r.jsx)(N.Z,T()(T()({},da),{},{listType:"picture-card",children:k.length>=1?null:H})),(0,r.jsx)(W.Z,{onChange:function(a){a.target.value&&ae([{uid:"2",name:a.target.value,url:a.target.value}])},placeholder:u.formatMessage({id:"pages.draw.swap2VidelDesc"})}),(0,r.jsx)(Z.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.swapVideoDesc"})})]}):w==="show"?(0,r.jsxs)(_.Z.Compact,{style:{width:"100%"},children:[(0,r.jsx)(W.Z,{placeholder:u.formatMessage({id:"pages.draw.inputIdShow"}),value:E,onChange:ue,onPressEnter:M}),(0,r.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):w==="showjobid"?(0,r.jsxs)(_.Z.Compact,{style:{width:"100%"},children:[(0,r.jsx)(W.Z,{placeholder:u.formatMessage({id:"pages.draw.inputJobIdShow"}),value:E,onChange:ue,onPressEnter:M}),(0,r.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):w==="imagine"?(0,r.jsxs)(B.Z,{vertical:!0,children:[(0,r.jsx)(N.Z,T()(T()({},ye),{},{listType:"picture-card",children:O.length>=5?null:H})),(0,r.jsxs)(B.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,r.jsx)(ie,{placeholder:"Prompt",value:E,onChange:ue,onPressEnter:M,autoSize:{minRows:1,maxRows:12}}),(0,r.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]})]}):w==="blend"?(0,r.jsxs)(B.Z,{vertical:!0,children:[(0,r.jsx)(N.Z,T()(T()({},ye),{},{listType:"picture-card",children:O.length>=5?null:H})),(0,r.jsxs)(_.Z,{style:{width:"100%",marginTop:"10px"},children:[(0,r.jsx)(Te.ZP.Group,{value:Be,onChange:jr,options:[{value:"PORTRAIT",label:u.formatMessage({id:"pages.draw.PORTRAIT"})},{value:"SQUARE",label:u.formatMessage({id:"pages.draw.SQUARE"})},{value:"LANDSCAPE",label:u.formatMessage({id:"pages.draw.LANDSCAPE"})}],optionType:"button"}),(0,r.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]})]}):w==="describe"?(0,r.jsxs)(B.Z,{vertical:!0,children:[(0,r.jsx)(N.Z,T()(T()({},ye),{},{listType:"picture-card",children:O.length>=1?null:H})),(0,r.jsx)(Z.ZP,{style:{marginTop:"10px"},type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):w==="shorten"?(0,r.jsxs)(B.Z,{style:{width:"100%",marginTop:"10px"},gap:6,children:[(0,r.jsx)(ie,{placeholder:"Prompt",value:E,onChange:ue,onPressEnter:M,autoSize:{minRows:1,maxRows:12}}),(0,r.jsx)(Z.ZP,{type:"primary",onClick:M,loading:J,children:u.formatMessage({id:"pages.draw.submitTask"})})]}):(0,r.jsx)(r.Fragment,{})},oa=function(){var e=document.getElementById("canvas");e.width=e.clientWidth,e.height=e.clientHeight;var a=e.getContext("2d");a.fillStyle="blue"},Lr=function(){return oe?dr?(0,r.jsxs)(B.Z,{vertical:!0,children:[(0,r.jsx)(Z.ZP,{style:{marginBottom:"10px"},icon:(0,r.jsx)(Ce.Z,{}),onClick:oa,children:u.formatMessage({id:"pages.draw.clear"})}),(0,r.jsx)("canvas",{style:{backgroundImage:"url('".concat(oe,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:Ke}),(0,r.jsx)(ie,{style:{marginTop:"10px"},rows:2,value:le,onChange:na})]}):(0,r.jsxs)(B.Z,{vertical:!0,children:[(0,r.jsx)(Z.ZP,{style:{marginBottom:"10px"},icon:(0,r.jsx)(Ce.Z,{}),onClick:oa,children:u.formatMessage({id:"pages.draw.clear"})}),(0,r.jsx)("canvas",{style:{backgroundImage:"url('".concat(oe,"')"),backgroundSize:"100% 100%"},id:"canvas",width:"550",height:Ke})]}):(0,r.jsx)(ie,{rows:3,value:le,onChange:na})};function Se(i){i.onSuccess()}var be=function(e){var a=e.type==="image/jpeg"||e.type==="image/png"||e.type==="video/mp4"||e.type==="image/webp";a||b.ZP.error(u.formatMessage({id:"pages.draw.onlyJpgPng"}));var t=e.size/1024/1024<10;return t||b.ZP.error(u.formatMessage({id:"pages.draw.limit10M"})),a&&t||N.Z.LIST_IGNORE},ye={customRequest:Se,beforeUpload:be,fileList:O,onChange:function(e){G(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},ua={customRequest:Se,beforeUpload:be,maxCount:1,fileList:R,onChange:function(e){ee(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},da={customRequest:Se,beforeUpload:be,maxCount:1,fileList:k,onChange:function(e){ae(e.fileList)},showUploadList:{showRemoveIcon:!0,showPreviewIcon:!1}},Or=function(){var e,a=!1;j==="INSIGHT_FACE"||j==="FACE_SWAP"||j==="VIDEO_FACE_SWAP"?(a=!0,e=[{value:"swap",label:"/swap"}]):e=[{value:"imagine",label:"/imagine"},{value:"blend",label:"/blend"},{value:"describe",label:"/describe"},{value:"shorten",label:"/shorten"},{value:"showjobid",label:"/show job_id"},{value:"show",label:"/show task_id"}];var t=Array.isArray(ra)?ra.map(function(l){return{value:l.channelId,label:l.channelId+" - "+(l.remark||""),disabled:!l.enable||!l.running}}):[];return(0,r.jsxs)(_.Z,{style:{marginBottom:"10px"},children:[(0,r.jsx)(Ie.Z,{value:a?"swap":w,style:{width:150},onChange:yr,options:e}),(0,r.jsx)(Ie.Z,{value:$,style:{width:320},onChange:wr,options:t,allowClear:!0,placeholder:u.formatMessage({id:"pages.draw.selectAccount"})}),(0,r.jsx)(Te.ZP.Group,{value:j,onChange:Cr,options:[{value:"MID_JOURNEY",label:"Midjourney"},{value:"NIJI_JOURNEY",label:"niji\u30FBjourney"},{value:"FACE_SWAP",label:"FaceSwap"},{value:"VIDEO_FACE_SWAP",label:"Video\u30FBFaceSwap"}],optionType:"button"})]})};return(0,r.jsxs)(ya._z,{children:[Fa,(0,r.jsx)(ne.Z,{style:{marginBottom:"15px",overflow:"auto",height:"70vh"},loading:Ba,id:"task-panel",children:Mr()}),(0,r.jsxs)(ne.Z,{children:[Or(),Br()]}),(0,r.jsx)(Pa.Z,{title:ar,open:_a,onCancel:Ar,onOk:Pr,confirmLoading:gr,width:600,children:Lr()})]})},Ea=Za}}]);
